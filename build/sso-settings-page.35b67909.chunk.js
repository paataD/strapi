"use strict";(self.webpackChunk_strapi_admin=self.webpackChunk_strapi_admin||[]).push([[302],{26930:function(Q,m,e){e.r(m),e.d(m,{SingleSignOn:function(){return R},default:function(){return Z}});var t=e(32735),L=e(96709),M=e(27649),y=e(82055),C=e(41415),I=e(17e3),O=e(87933),b=e(49372),A=e(15335),u=e(5803),P=e(9139),D=e(68465),T=e(84967),f=e(6407),l=e(19565),x=e(66456),F=e(89793),z=e.n(F),B=e(67879),h=e(15062),v=e(10328),S=e(78125),G=e(8997),i=e(24346),H=i.Ry().shape({autoRegister:i.Xg().required(l.I0.required),defaultRole:i.nK().when("autoRegister",(s,o)=>s?o.required(l.I0.required):o.nullable()),ssoLockedRoles:i.IX().of(i.nK().when("ssoLockedRoles",(s,o)=>s?o.required(l.I0.required):o.nullable()))});const R=()=>{const{formatMessage:s}=(0,B.Z)(),o=(0,h.v9)(S._),k=t.useMemo(()=>({...o.settings.sso,readRoles:o.settings.roles.read}),[o.settings.roles.read,o.settings.sso]),{isLoading:K,allowedActions:{canUpdate:c,canReadRoles:U}}=(0,l.ss)(k),[{formErrors:n,initialData:X,isLoading:N,modifiedData:r,showHeaderButtonLoader:W},$,{handleChange:d,handleSubmit:j}]=(0,v.G4)((0,G.IF)("providers/options"),H,()=>{},["autoRegister","defaultRole","ssoLockedRoles"]),{roles:p}=(0,v.bF)(U);(0,l.go)();const J=K||N;(0,t.useEffect)(()=>{if(n.defaultRole){const a='[name="defaultRole"]';document.querySelector(a).focus()}},[n]);const E=z()(X,r);return t.createElement(L.A,null,t.createElement(l.SL,{name:"SSO"}),t.createElement(M.o,{tabIndex:-1},t.createElement("form",{onSubmit:a=>{if(E){a.preventDefault();return}j(a)}},t.createElement(y.T,{primaryAction:t.createElement(C.z,{"data-testid":"save-button",disabled:E,loading:W,startIcon:t.createElement(x.Z,null),type:"submit",size:"L"},s({id:"global.save",defaultMessage:"Save"})),title:s({id:"Settings.sso.title",defaultMessage:"Single Sign-On"}),subtitle:s({id:"Settings.sso.description",defaultMessage:"Configure the settings for the Single Sign-On feature."})}),t.createElement(I.D,null,J?t.createElement(l.dO,null):t.createElement(O.k,{direction:"column",alignItems:"stretch",gap:4,background:"neutral0",padding:6,shadow:"filterShadow",hasRadius:!0},t.createElement(b.Z,{variant:"delta",as:"h2"},s({id:"global.settings",defaultMessage:"Settings"})),t.createElement(A.r,{gap:4},t.createElement(u.P,{col:6,m:6,s:12},t.createElement(P.s,{"aria-label":"autoRegister","data-testid":"autoRegister",disabled:!c,checked:r.autoRegister,hint:s({id:"Settings.sso.form.registration.description",defaultMessage:"Create new user on SSO login if no account exists"}),label:s({id:"Settings.sso.form.registration.label",defaultMessage:"Auto-registration"}),name:"autoRegister",offLabel:s({id:"app.components.ToggleCheckbox.off-label",defaultMessage:"Off"}),onLabel:s({id:"app.components.ToggleCheckbox.on-label",defaultMessage:"On"}),onChange:a=>{d({target:{name:"autoRegister",value:a.target.checked}})}})),t.createElement(u.P,{col:6,m:6,s:12},t.createElement(D.P,{disabled:!c,hint:s({id:"Settings.sso.form.defaultRole.description",defaultMessage:"It will attach the new authenticated user to the selected role"}),error:n.defaultRole?s({id:n.defaultRole.id,defaultMessage:n.defaultRole.id}):"",label:s({id:"Settings.sso.form.defaultRole.label",defaultMessage:"Default role"}),name:"defaultRole",onChange:a=>{d({target:{name:"defaultRole",value:a}})},placeholder:s({id:"components.InputSelect.option.placeholder",defaultMessage:"Choose here"}),value:r.defaultRole},p.map(({id:a,name:g})=>t.createElement(T.W,{key:a,value:a.toString()},g)))),t.createElement(u.P,{col:6,m:6,s:12},t.createElement(f.NU,{disabled:!c,hint:s({id:"Settings.sso.form.localAuthenticationLock.description",defaultMessage:"Select the roles for which you want to disable the local authentication"}),error:n.ssoLockedRoles?s({id:n.ssoLockedRoles.id,defaultMessage:n.ssoLockedRoles.id}):"",label:s({id:"Settings.sso.form.localAuthenticationLock.label",defaultMessage:"Local authentication lock-out"}),name:"ssoLockedRoles",onChange:a=>{d({target:{name:"ssoLockedRoles",value:a}})},placeholder:s({id:"components.InputSelect.option.placeholder",defaultMessage:"Choose here"}),onClear:()=>{d({target:{name:"ssoLockedRoles",emptyArray:[]}})},value:r.ssoLockedRoles||[],withTags:!0},p.map(({id:a,name:g})=>t.createElement(f.ML,{key:a,value:a.toString()},g))))))))))};var Z=()=>{const s=(0,h.v9)(S._);return t.createElement(l.O4,{permissions:s.settings.sso.main},t.createElement(R,null))}}}]);
